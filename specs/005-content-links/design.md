# ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¢ã‚¯ã‚»ã‚¹ãƒªãƒ³ã‚¯æ©Ÿèƒ½è¨­è¨ˆæ›¸

## æ¦‚è¦

ãƒ­ã‚°ã‚„ã‚¿ã‚°ã«é–¢é€£ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆå…¬å¼ã‚µã‚¤ãƒˆã€Wikipediaã€è³¼å…¥URLã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç­‰ï¼‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’å¯èƒ½ã«ã™ã‚‹æ©Ÿèƒ½ã®è¨­è¨ˆã€‚

## ç›®çš„

- è¶£å‘³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«é–¢ã™ã‚‹æƒ…å ±åé›†ã‚’å®¹æ˜“ã«ã™ã‚‹
- å…¬å¼ãƒšãƒ¼ã‚¸ã‚„è³¼å…¥ãƒšãƒ¼ã‚¸ã¸ã®å°ç·šã‚’æä¾›ã™ã‚‹
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®Ÿéš›ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«è§¦ã‚Œã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æŸ”è»Ÿæ€§ã‚’æ´»ã‹ã—ãŸæ‹¡å¼µæ€§ã®é«˜ã„è¨­è¨ˆ

## è¦ä»¶

### å¿…é ˆè¦ä»¶

1. **å…¬å¼ã‚µã‚¤ãƒˆã¸ã®ãƒªãƒ³ã‚¯**: ä½œå“ã®å…¬å¼ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã¸ã®ãƒªãƒ³ã‚¯
2. **Wikipediaç­‰ã®æƒ…å ±æº**: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è©³ç´°æƒ…å ±ãŒå¾—ã‚‰ã‚Œã‚‹ãƒªãƒ³ã‚¯
3. **è³¼å…¥ãƒ»è¦–è´URL**: å•†å“ã®è³¼å…¥ã‚„ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒªãƒ³ã‚¯
4. **UIã§ã®é©åˆ‡ãªè¡¨ç¤º**: ãƒªãƒ³ã‚¯ã®ç¨®é¡ãŒåˆ†ã‹ã‚Šã‚„ã™ãè¡¨ç¤ºã•ã‚Œã‚‹
5. **æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã¨ã®äº’æ›æ€§**: ç¾åœ¨ã®`metadata`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ´»ç”¨

### ä»»æ„è¦ä»¶

1. **è¤‡æ•°ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œ**: Amazonã€æ¥½å¤©ã€Netflixã€Crunchyrollç­‰ã®è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹
2. **ãƒªãƒ³ã‚¯ã‚¢ã‚¤ã‚³ãƒ³**: å„ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾å¿œã—ãŸã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º
3. **ãƒªãƒ³ã‚¯æ¤œè¨¼**: ç„¡åŠ¹ãªURLã®æ¤œå‡º
4. **ãƒ­ã‚°ã¸ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¿½åŠ **: ã‚¿ã‚°ã ã‘ã§ãªããƒ­ã‚°ã«ã‚‚ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æŒãŸã›ã‚‹

## è¨­è¨ˆã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

### 1. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ

#### 1.1 ã‚¿ã‚°ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

æ—¢å­˜ã®`tags.metadata`ï¼ˆJSONï¼‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ´»ç”¨ã—ã€ä»¥ä¸‹ã®æ§‹é€ ã‚’å®šç¾©ï¼š

```typescript
interface TagMetadata {
  // åŸºæœ¬æƒ…å ±
  category?: string;           // "anime", "manga", "game", "music" ç­‰
  year?: number;              // ç™ºå£²å¹´ãƒ»æ”¾é€å¹´
  
  // ãƒªãƒ³ã‚¯æƒ…å ±
  links?: {
    official?: string;        // å…¬å¼ã‚µã‚¤ãƒˆ
    wikipedia?: string;       // Wikipediaï¼ˆæ—¥æœ¬èª/è‹±èªï¼‰
    wikidataId?: string;      // Wikidata IDï¼ˆQç•ªå·ï¼‰
    
    // è³¼å…¥ãƒ»è¦–è´ã‚µãƒ¼ãƒ“ã‚¹
    amazon?: string;          // Amazonå•†å“ãƒšãƒ¼ã‚¸
    rakuten?: string;         // æ¥½å¤©å¸‚å ´
    
    // ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ»ãƒ‰ãƒ©ãƒï¼‰
    netflix?: string;
    amazonPrime?: string;
    crunchyroll?: string;
    
    // éŸ³æ¥½
    spotify?: string;
    appleMusic?: string;
    youtube?: string;
    
    // ã‚²ãƒ¼ãƒ 
    steam?: string;
    nintendoEshop?: string;
    playstationStore?: string;
    
    // ãã®ä»–
    myanimelist?: string;     // MyAnimeList
    anilist?: string;         // AniList
    vndb?: string;            // The Visual Novel Database
    
    // ã‚«ã‚¹ã‚¿ãƒ ãƒªãƒ³ã‚¯
    custom?: Array<{
      name: string;
      url: string;
      icon?: string;          // ã‚ªãƒ—ã‚·ãƒ§ãƒ³: emoji or icon name
    }>;
  };
  
  // ãã®ä»–ã®æƒ…å ±
  [key: string]: any;         // å°†æ¥ã®æ‹¡å¼µç”¨
}
```

#### 1.2 ãƒ­ã‚°ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼ˆå°†æ¥ã®æ‹¡å¼µï¼‰

ç¾åœ¨ã€ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯`metadata`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãªã„ãŸã‚ã€**å°†æ¥çš„ãªæ‹¡å¼µ**ã¨ã—ã¦ä»¥ä¸‹ã‚’æ¤œè¨ï¼š

**Option A: ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã«metadataã‚«ãƒ©ãƒ ã‚’è¿½åŠ **
```sql
ALTER TABLE logs ADD COLUMN metadata TEXT DEFAULT '{}';
```

**Option B: ã‚¿ã‚°ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§**
- ãƒ­ã‚°ã«ç´ã¥ãã‚¿ã‚°ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’é›†ç´„ã—ã¦è¡¨ç¤º
- è¿½åŠ ã®ãƒ†ãƒ¼ãƒ–ãƒ«å¤‰æ›´ä¸è¦
- ã‚ˆã‚Šç°¡æ½”ã§å®Ÿè£…ãŒå®¹æ˜“

â†’ **æ¨å¥¨: Option Bï¼ˆåˆæœŸå®Ÿè£…ï¼‰**ã€å¿…è¦ã«å¿œã˜ã¦Option Aã«ç§»è¡Œ

### 2. UIè¨­è¨ˆ

#### 2.1 ã‚¿ã‚°è©³ç´°ãƒšãƒ¼ã‚¸

**è¡¨ç¤ºä½ç½®**: ã‚¿ã‚°è©³ç´°ã‚«ãƒ¼ãƒ‰å†…ã®ã€Œâ„¹ï¸ æƒ…å ±ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã€ŒğŸ”— é–¢é€£ãƒªãƒ³ã‚¯ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 

**ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ¡ˆ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚¿ã‚°è©³ç´°ã‚«ãƒ¼ãƒ‰                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ èª¬æ˜                                   â”‚
â”‚ [Markdownè¡¨ç¤º]                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸŒ å…¬å¼ã‚µã‚¤ãƒˆ                         â”‚ â”‚
â”‚ â”‚ ğŸ“– Wikipedia                         â”‚ â”‚
â”‚ â”‚ ğŸ›’ Amazon ã§è³¼å…¥                     â”‚ â”‚
â”‚ â”‚ ğŸ“º Netflix ã§è¦–è´                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â„¹ï¸ æƒ…å ±                                   â”‚
â”‚ ğŸ“Š ä½¿ç”¨å›æ•°: XX å›                        â”‚
â”‚ ...                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³**:
- ã‚¢ã‚¤ã‚³ãƒ³ + ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«
- `target="_blank" rel="noopener noreferrer"` ã§æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
- hoveræ™‚ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼URLè¡¨ç¤ºï¼ˆtooltipï¼‰
- çµ±ä¸€ã•ã‚ŒãŸã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆshadcn/ui Buttonï¼‰

#### 2.2 ãƒ­ã‚°è©³ç´°ãƒšãƒ¼ã‚¸

**Option 1: ã‚¿ã‚°ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’é›†ç´„è¡¨ç¤º**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ­ã‚°è©³ç´°                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æœ¬æ–‡]                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ·ï¸ ã‚¿ã‚°                                   â”‚
â”‚ #Anime  #AttackOnTitan                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯ï¼ˆã‚¿ã‚°ã‹ã‚‰ï¼‰                  â”‚
â”‚ Attack on Titan:                         â”‚
â”‚   ğŸŒ å…¬å¼ã‚µã‚¤ãƒˆ                           â”‚
â”‚   ğŸ“– Wikipedia                           â”‚
â”‚   ğŸ“º Netflix ã§è¦–è´                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Option 2: å„ã‚¿ã‚°ã®ä¸‹ã«ãƒªãƒ³ã‚¯ã‚’è¡¨ç¤º**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ·ï¸ ã‚¿ã‚°                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ #AttackOnTitan                    â”‚   â”‚
â”‚ â”‚ ğŸŒ å…¬å¼ ğŸ“– Wikipedia ğŸ“º Netflix    â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ #Anime                            â”‚   â”‚
â”‚ â”‚ ğŸ“– Wikipedia                      â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

â†’ **æ¨å¥¨: Option 1** - ã‚ˆã‚Šèª­ã¿ã‚„ã™ãã€è¦–è¦šçš„ã«ã‚¯ãƒªãƒ¼ãƒ³

#### 2.3 ãƒªãƒ³ã‚¯ã‚¿ã‚¤ãƒ—ã¨ã‚¢ã‚¤ã‚³ãƒ³ã®ãƒãƒƒãƒ”ãƒ³ã‚°

| ãƒªãƒ³ã‚¯ã‚¿ã‚¤ãƒ— | ã‚¢ã‚¤ã‚³ãƒ³ | ãƒ©ãƒ™ãƒ«ä¾‹ |
|------------|---------|---------|
| official | ğŸŒ | å…¬å¼ã‚µã‚¤ãƒˆ |
| wikipedia | ğŸ“– | Wikipedia |
| amazon | ğŸ›’ | Amazon |
| rakuten | ğŸ›’ | æ¥½å¤©å¸‚å ´ |
| netflix | ğŸ“º | Netflix |
| amazonPrime | ğŸ“º | Prime Video |
| crunchyroll | ğŸ“º | Crunchyroll |
| spotify | ğŸµ | Spotify |
| appleMusic | ğŸµ | Apple Music |
| youtube | â–¶ï¸ | YouTube |
| steam | ğŸ® | Steam |
| myanimelist | ğŸ“Š | MyAnimeList |
| custom | ğŸ”— | (ã‚«ã‚¹ã‚¿ãƒ å) |

### 3. APIè¨­è¨ˆ

#### 3.1 æ—¢å­˜APIã®æ´»ç”¨

ç¾åœ¨ã®APIä»•æ§˜ï¼ˆ`/api/v1/openapi.yaml`ï¼‰ã§ã¯ã€ã‚¿ã‚°ã®`metadata`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯æ—¢ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ï¼š

```yaml
Tag:
  properties:
    metadata:
      type: object
      description: Flexible metadata storage
```

**å¤‰æ›´ä¸è¦**: æ—¢å­˜ã®ã‚¿ã‚°ä½œæˆãƒ»æ›´æ–°APIã§`metadata.links`ã‚’è¨­å®šã§ãã‚‹

#### 3.2 ã‚¿ã‚°ä½œæˆãƒ»æ›´æ–°æ™‚ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆ`backend/src/models/Tag.ts`ï¼‰ã§ä»¥ä¸‹ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰:

```typescript
class TagModel {
  static isValidMetadata(metadata: any): boolean {
    if (typeof metadata !== 'object') return false;
    
    // links ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚‹å ´åˆã€å„URLãŒæœ‰åŠ¹ã‹ãƒã‚§ãƒƒã‚¯
    if (metadata.links) {
      for (const [key, value] of Object.entries(metadata.links)) {
        if (key === 'custom') {
          // custom ãƒªãƒ³ã‚¯ã®é…åˆ—ãƒã‚§ãƒƒã‚¯
          if (!Array.isArray(value)) return false;
          for (const link of value) {
            if (!link.name || !link.url) return false;
            if (!isValidUrl(link.url)) return false;
          }
        } else if (value && typeof value === 'string') {
          // å˜ä¸€URLã®ãƒã‚§ãƒƒã‚¯
          if (!isValidUrl(value)) return false;
        }
      }
    }
    
    return true;
  }
}

function isValidUrl(url: string): boolean {
  try {
    new URL(url);
    return true;
  } catch {
    return false;
  }
}
```

### 4. å®Ÿè£…è¨ˆç”»

#### Phase 1: åŸºæœ¬å®Ÿè£…ï¼ˆå¿…é ˆï¼‰

1. **ãƒ‡ãƒ¼ã‚¿æº–å‚™**
   - ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã«å…·ä½“çš„ãªãƒªãƒ³ã‚¯ä¾‹ã‚’è¿½åŠ 
   - Attack on Titanã€Animeç­‰ã®ã‚¿ã‚°ã«`metadata.links`ã‚’è¨­å®š

2. **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ**
   - `ContentLinks.tsx`: ãƒªãƒ³ã‚¯è¡¨ç¤ºç”¨ã®å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
   - ãƒªãƒ³ã‚¯ã‚¿ã‚¤ãƒ—ã‹ã‚‰ã‚¢ã‚¤ã‚³ãƒ³ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°

3. **ã‚¿ã‚°è©³ç´°ãƒšãƒ¼ã‚¸çµ±åˆ**
   - `TagDetailPage.tsx`ã«`ContentLinks`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ 
   - ã€ŒğŸ”— é–¢é€£ãƒªãƒ³ã‚¯ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤º

4. **ãƒ­ã‚°è©³ç´°ãƒšãƒ¼ã‚¸çµ±åˆ**
   - `LogDetailPage.tsx`ã§ã‚¿ã‚°ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’é›†ç´„
   - é–¢é€£ãƒªãƒ³ã‚¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤º

5. **ã‚¿ã‚°ä½œæˆãƒ»ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ æ”¹å–„**
   - `TagForm.tsx`ã§ãƒªãƒ³ã‚¯å…¥åŠ›UIã‚’è¿½åŠ ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

#### Phase 2: æ‹¡å¼µæ©Ÿèƒ½ï¼ˆä»»æ„ï¼‰

1. **ãƒªãƒ³ã‚¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**
   - Open Graph APIã§ãƒªãƒ³ã‚¯ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±å–å¾—
   - ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã®è¡¨ç¤º

2. **ãƒªãƒ³ã‚¯åˆ†æ**
   - ãƒªãƒ³ã‚¯ã®ã‚¯ãƒªãƒƒã‚¯æ•°ã‚’è¨˜éŒ²
   - äººæ°—ã®ã‚ã‚‹ãƒªãƒ³ã‚¯ã‚’è¡¨ç¤º

3. **ãƒ­ã‚°ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å¯¾å¿œ**
   - ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã«`metadata`ã‚«ãƒ©ãƒ è¿½åŠ 
   - ãƒ­ã‚°å›ºæœ‰ã®ãƒªãƒ³ã‚¯ã‚’è¨­å®šå¯èƒ½ã«

4. **è‡ªå‹•ãƒªãƒ³ã‚¯ææ¡ˆ**
   - ã‚¿ã‚°åã‹ã‚‰è‡ªå‹•çš„ã«Wikipedia URLã‚’ç”Ÿæˆ
   - å¤–éƒ¨APIã‚’ä½¿ã£ãŸæƒ…å ±è£œå®Œ

### 5. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

1. **XSSå¯¾ç­–**: URLã¯å¿…ãš`target="_blank" rel="noopener noreferrer"`ã§é–‹ã
2. **URLãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: ä¸æ­£ãªã‚¹ã‚­ãƒ¼ãƒ ï¼ˆ`javascript:`ç­‰ï¼‰ã‚’é˜²ã
3. **å¤–éƒ¨ãƒªãƒ³ã‚¯è­¦å‘Š**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¤–éƒ¨ã‚µã‚¤ãƒˆã«ç§»å‹•ã™ã‚‹ã“ã¨ã‚’æ˜ç¤º
4. **HTTPSæ¨å¥¨**: å¯èƒ½ãªé™ã‚ŠHTTPSã®URLã‚’ä½¿ç”¨

### 6. ãƒ†ã‚¹ãƒˆè¨ˆç”»

#### 6.1 ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

- `TagModel.isValidMetadata()` ã®ãƒ†ã‚¹ãƒˆ
- URLãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆ

#### 6.2 çµ±åˆãƒ†ã‚¹ãƒˆ

- ã‚¿ã‚°ä½œæˆæ™‚ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãä¿å­˜ã•ã‚Œã‚‹
- ã‚¿ã‚°è©³ç´°å–å¾—æ™‚ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã‚‹

#### 6.3 UIãƒ†ã‚¹ãƒˆ

- ãƒªãƒ³ã‚¯ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯ã§æ–°ã—ã„ã‚¿ãƒ–ãŒé–‹ã
- å­˜åœ¨ã—ãªã„ãƒªãƒ³ã‚¯ã‚¿ã‚¤ãƒ—ã¯è¡¨ç¤ºã•ã‚Œãªã„

### 7. ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ä¾‹

```sql
-- ã‚¿ã‚°ã«ãƒªãƒ³ã‚¯æƒ…å ±ã‚’è¿½åŠ 
UPDATE tags SET metadata = json('{
  "category": "anime",
  "year": 2013,
  "studio": "Studio WIT",
  "episodes": 25,
  "links": {
    "official": "https://shingeki.tv/",
    "wikipedia": "https://ja.wikipedia.org/wiki/é€²æ’ƒã®å·¨äºº_(ã‚¢ãƒ‹ãƒ¡)",
    "myanimelist": "https://myanimelist.net/anime/16498/Shingeki_no_Kyojin",
    "crunchyroll": "https://www.crunchyroll.com/series/GR751KNZY/attack-on-titan",
    "amazon": "https://www.amazon.co.jp/dp/B00F3S9TXE",
    "netflix": "https://www.netflix.com/title/70299043"
  }
}') WHERE name = 'Attack on Titan';

UPDATE tags SET metadata = json('{
  "category": "media",
  "links": {
    "wikipedia": "https://ja.wikipedia.org/wiki/ã‚¢ãƒ‹ãƒ¡",
    "myanimelist": "https://myanimelist.net/"
  }
}') WHERE name = 'Anime';

UPDATE tags SET metadata = json('{
  "category": "game",
  "genre": "Action RPG",
  "year": 2022,
  "links": {
    "official": "https://en.bandainamcoent.eu/elden-ring/elden-ring",
    "steam": "https://store.steampowered.com/app/1245620/ELDEN_RING/",
    "wikipedia": "https://ja.wikipedia.org/wiki/ã‚¨ãƒ«ãƒ‡ãƒ³ãƒªãƒ³ã‚°",
    "playstationStore": "https://store.playstation.com/ja-jp/product/JP0700-PPSA09157_00-ELDENRING0000000"
  }
}') WHERE name = 'Gaming';
```

### 8. UIå®Ÿè£…ä¾‹

#### ContentLinks.tsx

```typescript
import { ExternalLink } from 'lucide-react';
import { Button } from '@/components/ui/button';

interface ContentLinksProps {
  links: Record<string, string | Array<{name: string, url: string, icon?: string}>>;
  className?: string;
}

const linkConfig = {
  official: { icon: 'ğŸŒ', label: 'å…¬å¼ã‚µã‚¤ãƒˆ' },
  wikipedia: { icon: 'ğŸ“–', label: 'Wikipedia' },
  amazon: { icon: 'ğŸ›’', label: 'Amazon' },
  netflix: { icon: 'ğŸ“º', label: 'Netflix' },
  spotify: { icon: 'ğŸµ', label: 'Spotify' },
  steam: { icon: 'ğŸ®', label: 'Steam' },
  myanimelist: { icon: 'ğŸ“Š', label: 'MyAnimeList' },
  // ... ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹
};

export function ContentLinks({ links, className = '' }: ContentLinksProps) {
  if (!links || Object.keys(links).length === 0) {
    return null;
  }

  return (
    <div className={`space-y-2 ${className}`}>
      <h3 className="text-sm font-semibold text-gray-700 mb-2">ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯</h3>
      <div className="flex flex-wrap gap-2">
        {Object.entries(links).map(([key, value]) => {
          if (key === 'custom' && Array.isArray(value)) {
            return value.map((link, idx) => (
              <Button
                key={`${key}-${idx}`}
                variant="outline"
                size="sm"
                asChild
              >
                <a
                  href={link.url}
                  target="_blank"
                  rel="noopener noreferrer"
                  className="flex items-center gap-2"
                >
                  <span>{link.icon || 'ğŸ”—'}</span>
                  <span>{link.name}</span>
                  <ExternalLink size={14} />
                </a>
              </Button>
            ));
          }
          
          if (typeof value === 'string' && linkConfig[key]) {
            const config = linkConfig[key];
            return (
              <Button
                key={key}
                variant="outline"
                size="sm"
                asChild
              >
                <a
                  href={value}
                  target="_blank"
                  rel="noopener noreferrer"
                  className="flex items-center gap-2"
                >
                  <span>{config.icon}</span>
                  <span>{config.label}</span>
                  <ExternalLink size={14} />
                </a>
              </Button>
            );
          }
          
          return null;
        })}
      </div>
    </div>
  );
}
```

### 9. ã¾ã¨ã‚

ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€ä»¥ä¸‹ãŒå®Ÿç¾ã•ã‚Œã¾ã™ï¼š

âœ… **æŸ”è»Ÿæ€§**: æ—¢å­˜ã®`metadata`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ´»ç”¨ã—ã€ä»»æ„ã®ãƒªãƒ³ã‚¯ã‚’è¿½åŠ å¯èƒ½  
âœ… **æ‹¡å¼µæ€§**: æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã®è¿½åŠ ãŒå®¹æ˜“  
âœ… **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**: åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¢ã‚¤ã‚³ãƒ³ã¨ãƒ©ãƒ™ãƒ«ã§ãƒªãƒ³ã‚¯ã‚’è¡¨ç¤º  
âœ… **äº’æ›æ€§**: æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã‚„APIã«å½±éŸ¿ã‚’ä¸ãˆãªã„  
âœ… **æ®µéšçš„å®Ÿè£…**: Phase 1ï¼ˆå¿…é ˆï¼‰â†’ Phase 2ï¼ˆä»»æ„ï¼‰ã®é †ã«å®Ÿè£…å¯èƒ½  

ã“ã®è¨­è¨ˆæ›¸ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€Phase 1ã®å®Ÿè£…ã‚’é€²ã‚ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¿ã‚°ã‚„ãƒ­ã‚°ã«é–¢é€£ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ç°¡å˜ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
